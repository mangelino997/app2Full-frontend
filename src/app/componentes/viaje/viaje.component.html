<div id="viaje" class="container-fluid" (window:keydown)="manejarEvento($event.keyCode)">
    <div class="row">
        <div class="col" class="centrar">
            <nav mat-tab-nav-bar>
                <a mat-tab-link disabled>GUIA DE SERVICIO</a>
                <a mat-tab-link *ngFor="let pestania of pestanias" [active]="activeLink == pestania.nombre" (click)="seleccionarPestania(pestania.id, pestania.nombre, 0)">{{pestania.nombre}}</a>
            </nav>
        </div>
    </div>
    <div class="contenedor" *ngIf="indiceSeleccionado < 5">
        <mat-card style="background-color: #F8F9FA">
            <div class="row">
                <div class="col">
                    <form [formGroup]="formularioViajePropio">
                        <div class="row" *ngIf="mostrarAutocompletado">
                            <div class="col-md-4">
                                <div class="form-group has-float-label">
                                    <label for="idAutocompletado" class="tamanio-label">Buscar Guía de Servicio</label>
                                    <input id="idAutocompletado" class="form-control form-control-sm color-busqueda"
                                        autocomplete="off" type="number" matInput formControlName="id">
                                    <!-- <label for="idAutocompletado" class="tamanio-label">Buscar Guía de Servicio</label>
                                    <input id="idAutocompletado" class="form-control form-control-sm color-busqueda"
                                        autocomplete="off" type="text" matInput [formControl]="autocompletado"
                                        [matAutocomplete]="auto">
                                    <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn.bind(this)">
                                        <mat-option *ngFor="let item of resultados" [value]="item" (onSelectionChange)="formulario.setValue(item)">
                                            {{item.alias}}
                                        </mat-option>
                                    </mat-autocomplete> -->
                                </div>
                            </div>
                            <div class="col-md-4">
                                <button mat-raised-button color="primary" (click)="obtenerPorId()">Buscar</button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-2">
                                <div class="form-group has-float-label">
                                    <label for="idCodigo" class="tamanio-label-titulo">N° Guía Serv.</label>
                                    <input id="idCodigo" type="number" formControlName="id" class="form-control form-control-sm"
                                        readonly>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group has-float-label">
                                    <label for="idFecha" class="tamanio-label-titulo">Fecha</label>
                                    <input id="idFecha" type="date" formControlName="fecha" autocomplete="off" class="form-control form-control-sm"
                                        [readonly]="soloLectura">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group has-float-label">
                                    <label for="idEsPropio" class="tamanio-label-titulo">Tipo de Viaje *</label>
                                    <mat-select id="idEsPropio" class="form-control form-control-sm" [formControl]="tipoViaje">
                                        <mat-option [value]="false">Tercerizado</mat-option>
                                        <mat-option [value]="true">Propio</mat-option>
                                    </mat-select>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group has-float-label">
                                    <label for="idEsRemolquePropio" class="tamanio-label-titulo">Tipo de Remol. *</label>
                                    <mat-select id="idEsRemolquePropio" class="form-control form-control-sm"
                                        formControlName="esRemolquePropio">
                                        <mat-option [value]="false">Tercerizado</mat-option>
                                        <mat-option [value]="true">Propio</mat-option>
                                    </mat-select>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group has-float-label">
                                    <label for="idSucursal" class="tamanio-label-titulo">Sucursal *</label>
                                    <mat-select id="idSucursal" class="form-control form-control-sm" formControlName="sucursal"
                                        [compareWith]="compareFn">
                                        <mat-option *ngFor="let itemSucursal of sucursales" [value]="itemSucursal">
                                            {{itemSucursal.nombre}}
                                        </mat-option>
                                    </mat-select>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group has-float-label">
                                    <label for="idUsuario" class="tamanio-label-titulo">Usuario</label>
                                    <input id="idUsuario" type="text" class="form-control form-control-sm" readonly
                                        [formControl]="usuarioNombre">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group has-float-label">
                                    <label for="idVehiculo" class="tamanio-label-titulo">Vehículo *</label>
                                    <input id="idVehiculo" class="form-control form-control-sm" type="text" matInput
                                        [formControl]="tipoViaje.value ? formularioViajePropio.get('vehiculo') : formularioViajePropio.get('vehiculoProveedor')"
                                        [matAutocomplete]="autoVehiculo" autocomplete="off" [readonly]="soloLectura">
                                    <mat-autocomplete #autoVehiculo="matAutocomplete" [displayWith]="displayFa.bind(this)">
                                        <mat-option *ngFor="let itemVehiculo of resultadosVehiculos" [value]="itemVehiculo">
                                            {{itemVehiculo.dominio}}
                                        </mat-option>
                                    </mat-autocomplete>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group has-float-label">
                                    <label for="idVehiculoRemolque" class="tamanio-label-titulo">Vehículo Remolque *</label>
                                    <input id="idVehiculoRemolque" class="form-control form-control-sm" type="text"
                                        matInput [formControl]="formularioViajePropio.get('esRemolquePropio').value ? formularioViajePropio.get('vehiculoRemolque') : formularioViajePropio.get('vehiculoProveedorRemolque')"
                                        [matAutocomplete]="autoVehiculoRemolque" autocomplete="off" [readonly]="soloLectura">
                                    <mat-autocomplete #autoVehiculoRemolque="matAutocomplete" [displayWith]="displayFa.bind(this)">
                                        <mat-option *ngFor="let itemVehiculoRemolque of resultadosVehiculosRemolques"
                                            [value]="itemVehiculoRemolque">
                                            {{itemVehiculoRemolque.dominio}}
                                        </mat-option>
                                    </mat-autocomplete>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group has-float-label">
                                    <label for="idPersonal" class="tamanio-label-titulo">Chofer *</label>
                                    <input id="idPersonal" class="form-control form-control-sm" type="text" matInput
                                        [formControl]="tipoViaje.value ? formularioViajePropio.get('personal') : formularioViajePropio.get('choferProveedor')"
                                        [matAutocomplete]="autoChofer" autocomplete="off" [readonly]="soloLectura">
                                    <mat-autocomplete #autoChofer="matAutocomplete" [displayWith]="displayFn.bind(this)">
                                        <mat-option *ngFor="let itemChofer of resultadosChoferes" [value]="itemChofer">
                                            {{itemChofer.alias}}
                                        </mat-option>
                                    </mat-autocomplete>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </mat-card>
        <br>
        <mat-horizontal-stepper [linear]="true" #stepper>
            <mat-step [stepControl]="formularioViajePropio">
                <ng-template matStepLabel>Tramos</ng-template><br>
                <form [formGroup]="formularioViajePropioTramo">
                    <app-viaje-tramo (dataEvent)="recibirTramos($event)"></app-viaje-tramo>
                </form>
            </mat-step>
            <mat-step [stepControl]="formularioViajePropioCombustible">
                <ng-template matStepLabel>Ordenes Combustibles</ng-template><br>
                <form [formGroup]="formularioViajePropioCombustible">
                    <app-viaje-combustible (dataEvent)="recibirCombustibles($event)"></app-viaje-combustible>
                </form>
            </mat-step>
            <mat-step [stepControl]="formularioViajePropioEfectivo">
                <ng-template matStepLabel>Adelantos Efectivo</ng-template><br>
                <form [formGroup]="formularioViajePropioEfectivo">
                    <app-viaje-efectivo (dataEvent)="recibirEfectivos($event)"></app-viaje-efectivo>
                </form>
            </mat-step>
            <mat-step [stepControl]="formularioViajePropioInsumo">
                <ng-template matStepLabel>Ordenes Insumo</ng-template><br>
                <form [formGroup]="formularioViajePropioInsumo">
                    <app-viaje-insumo (dataEvent)="recibirInsumos($event)"></app-viaje-insumo>
                </form>
            </mat-step>
            <mat-step [stepControl]="formularioViajeRemitoDC">
                <ng-template matStepLabel>Remitos Dadores Carga</ng-template><br>
                <form [formGroup]="formularioViajeRemitoDC">
                    
                </form>
            </mat-step>
            <mat-step [stepControl]="formularioViajeRemito">
                <ng-template matStepLabel>Remitos Generales</ng-template><br>
                <form [formGroup]="formularioViajeRemito">
                    <app-viaje-remito-gs (dataEvent)="recibirRemitos($event)"></app-viaje-remito-gs>
                </form>
            </mat-step>
            <mat-step [stepControl]="formularioViajePropioGasto">
                <ng-template matStepLabel>Gastos</ng-template><br>
                <form [formGroup]="formularioViajePropioGasto">
                    <app-viaje-gasto (dataEvent)="recibirGastos($event)"></app-viaje-gasto>
                </form>
            </mat-step>
            <mat-step [stepControl]="formularioViajePropioPeaje">
                <ng-template matStepLabel>Peaje</ng-template><br>
                <form [formGroup]="formularioViajePropioPeaje">
                    <app-viaje-peaje (dataEvent)="recibirPeajes($event)"></app-viaje-peaje>
                </form>
            </mat-step>
        </mat-horizontal-stepper>
        <div class="row">
            <div class="centrar">
                <button id="idBoton" mat-raised-button color="primary" formnovalidate (click)="agregar()" [disabled]="!formularioViajePropio.valid">
                    Agregar
                </button>
            </div>
        </div>
        <!-- <mat-sidenav-container>
            <mat-sidenav #sidenav mode="side" opened class="sidenav" [fixedInViewport]="true" [fixedTopGap]="165"
                [fixedBottomGap]="0">
                <div class="container-fluid-custom">
                    <div class="row contenedor" *ngFor="let listaOp of opciones; let idx = index">
                        <div class="col">
                            <button [ngClass]="{true:'activar-boton-subopcion'}[botonOpcionActivo === idx]" type="button"
                                class="btn btn-outline-primary btn-block btn-sm" (click)="seleccionarOpcion(listaOp.id, idx)">
                                {{listaOp.nombre}}</button>
                        </div>
                    </div>
                </div>
            </mat-sidenav>
            <mat-sidenav-content class="sidenav-content">
                <div class="container-fluid">
                    <div class="row contenedor">
                        <div class="col">
                            <div class="contenedor-top-titulo">
                                <form [formGroup]="formularioViajePropio">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group has-float-label" *ngIf="mostrarAutocompletado">
                                                <label for="idAutocompletado" class="tamanio-label">Buscar Guía de Servicio</label>
                                                <input id="idAutocompletado" class="form-control form-control-sm color-busqueda"
                                                    autocomplete="off" type="text" matInput [formControl]="autocompletado"
                                                    [matAutocomplete]="auto">
                                                <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn.bind(this)">
                                                    <mat-option *ngFor="let item of resultados" [value]="item"
                                                        (onSelectionChange)="formulario.setValue(item)">
                                                        {{item.alias}}
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-2">
                                            <div class="form-group has-float-label">
                                                <label for="idCodigo" class="tamanio-label-titulo">N° Guía Serv.</label>
                                                <input id="idCodigo" type="number" formControlName="id" class="form-control form-control-sm"
                                                    readonly>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group has-float-label">
                                                <label for="idFecha" class="tamanio-label-titulo">Fecha</label>
                                                <input id="idFecha" type="date" formControlName="fecha" autocomplete="off"
                                                    class="form-control form-control-sm" [readonly]="soloLectura">
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group has-float-label">
                                                <label for="idEsPropio" class="tamanio-label-titulo">Tipo de Viaje *</label>
                                                <mat-select id="idEsPropio" class="form-control form-control-sm"
                                                    [formControl]="tipoViaje">
                                                    <mat-option [value]="false">Tercerizado</mat-option>
                                                    <mat-option [value]="true">Propio</mat-option>
                                                </mat-select>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group has-float-label">
                                                <label for="idEsRemolquePropio" class="tamanio-label-titulo">Tipo de Remol. *</label>
                                                <mat-select id="idEsRemolquePropio" class="form-control form-control-sm"
                                                    formControlName="esRemolquePropio">
                                                    <mat-option [value]="false">Tercerizado</mat-option>
                                                    <mat-option [value]="true">Propio</mat-option>
                                                </mat-select>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group has-float-label">
                                                <label for="idSucursal" class="tamanio-label-titulo">Sucursal *</label>
                                                <mat-select id="idSucursal" class="form-control form-control-sm"
                                                    formControlName="sucursal" [compareWith]="compareFn">
                                                    <mat-option *ngFor="let itemSucursal of sucursales" [value]="itemSucursal">
                                                        {{itemSucursal.nombre}}
                                                    </mat-option>
                                                </mat-select>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group has-float-label">
                                                <label for="idUsuario" class="tamanio-label-titulo">Usuario</label>
                                                <input id="idUsuario" type="text" class="form-control form-control-sm"
                                                    readonly [formControl]="usuarioNombre">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group has-float-label">
                                                <label for="idVehiculo" class="tamanio-label-titulo">Vehículo *</label>
                                                <input id="idVehiculo" class="form-control form-control-sm" type="text"
                                                    matInput [formControl]="tipoViaje.value ? formularioViajePropio.get('vehiculo') : formularioViajePropio.get('vehiculoProveedor')"
                                                    [matAutocomplete]="autoVehiculo" autocomplete="off" [readonly]="soloLectura">
                                                <mat-autocomplete #autoVehiculo="matAutocomplete" [displayWith]="displayFa.bind(this)">
                                                    <mat-option *ngFor="let itemVehiculo of resultadosVehiculos"
                                                        [value]="itemVehiculo">
                                                        {{itemVehiculo.dominio}}
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group has-float-label">
                                                <label for="idVehiculoRemolque" class="tamanio-label-titulo">Vehículo Remolque *</label>
                                                <input id="idVehiculoRemolque" class="form-control form-control-sm"
                                                    type="text" matInput [formControl]="formularioViajePropio.get('esRemolquePropio').value ? formularioViajePropio.get('vehiculoRemolque') : formularioViajePropio.get('vehiculoProveedorRemolque')"
                                                    [matAutocomplete]="autoVehiculoRemolque" autocomplete="off"
                                                    [readonly]="soloLectura">
                                                <mat-autocomplete #autoVehiculoRemolque="matAutocomplete" [displayWith]="displayFa.bind(this)">
                                                    <mat-option *ngFor="let itemVehiculoRemolque of resultadosVehiculosRemolques"
                                                        [value]="itemVehiculoRemolque">
                                                        {{itemVehiculoRemolque.dominio}}
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group has-float-label">
                                                <label for="idPersonal" class="tamanio-label-titulo">Chofer *</label>
                                                <input id="idPersonal" class="form-control form-control-sm" type="text"
                                                    matInput [formControl]="tipoViaje.value ? formularioViajePropio.get('personal') : formularioViajePropio.get('choferProveedor')"
                                                    [matAutocomplete]="autoChofer" autocomplete="off" [readonly]="soloLectura">
                                                <mat-autocomplete #autoChofer="matAutocomplete" [displayWith]="displayFn.bind(this)">
                                                    <mat-option *ngFor="let itemChofer of resultadosChoferes" [value]="itemChofer">
                                                        {{itemChofer.alias}}
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <mat-divider></mat-divider>
                            <div class="contenedor-top" *ngIf="opcionSeleccionada == 22">
                                <app-viaje-tramo (dataEvent)="recibirTramos($event)"></app-viaje-tramo>
                            </div>
                            <div class="contenedor-top" *ngIf="opcionSeleccionada == 23">
                                <app-viaje-combustible (dataEvent)="recibirCombustibles($event)"></app-viaje-combustible>
                            </div>
                            <div class="contenedor-top" *ngIf="opcionSeleccionada == 24">
                                <app-viaje-efectivo (dataEvent)="recibirEfectivos($event)"></app-viaje-efectivo>
                            </div>
                            <div class="contenedor-top" *ngIf="opcionSeleccionada == 25">
                                <app-viaje-insumo (dataEvent)="recibirInsumos($event)"></app-viaje-insumo>
                            </div>
                            <div class="contenedor-top" *ngIf="opcionSeleccionada == 26"></div>
                            <div class="contenedor-top" *ngIf="opcionSeleccionada == 27">
                                <app-viaje-remito-gs (dataEvent)="recibirRemitos($event)"></app-viaje-remito-gs>
                            </div>
                            <div class="contenedor-top" *ngIf="opcionSeleccionada == 28">
                                <app-viaje-gasto (dataEvent)="recibirGastos($event)"></app-viaje-gasto>
                            </div>
                            <div class="contenedor-top" *ngIf="opcionSeleccionada == 29">
                                <app-viaje-peaje (dataEvent)="recibirPeajes($event)"></app-viaje-peaje>
                            </div>
                            <br>
                            <div class="row">
                                <div class="centrar">
                                    <button id="idBoton" mat-raised-button color="primary" formnovalidate (click)="agregar()"
                                        [disabled]="!formularioViajePropio.valid">
                                        Agregar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </mat-sidenav-content>
        </mat-sidenav-container> -->
    </div>
    <div class="row justify-content-center" *ngIf="indiceSeleccionado == 5">
        <div class="col-md-12">
            <table class="table table-bordered table-striped table-sm">
                <thead>
                    <tr>
                        <th class="text-center" style="width:5%" scope="col">#</th>
                        <th class="text-center" style="width:20%" scope="col">Empresa Emisión</th>
                        <th class="text-center" style="width:15%" scope="col">Sucursal</th>
                        <th class="text-center" style="width:15%" scope="col">Fecha</th>
                        <th class="text-center" style="width:15%" scope="col">Vehículo</th>
                        <th class="text-center" style="width:20%" scope="col">Chofer</th>
                        <th class="text-center" style="width:5%" scope="col">-</th>
                        <th class="text-center" style="width:5%" scope="col">-</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let l of listaCompleta; let i = index">
                        <td align="center">
                            <span>{{i + 1}}</span>
                        </td>
                        <td align="center">
                            <span>{{l.empresaEmision.razonSocial}}</span>
                        </td>
                        <td align="center">
                            <span>{{l.sucursal.nombre}}</span>
                        </td>
                        <td align="center">
                            <span>{{l.fecha | date: 'dd/MM/yyyy'}}</span>
                        </td>
                        <td align="center">
                            <span>{{l.vehiculo.dominio}}</span>
                        </td>
                        <td align="center">
                            <span>{{l.personal.nombreCompleto}}</span>
                        </td>
                        <td align="center">
                            <span class="cursor-color" (click)="activarConsultar(l)">Ver</span>
                        </td>
                        <td align="center">
                            <span class="cursor-color" (click)="activarActualizar(l)">Mod</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>