<div class="row justify-content-center padd-20">
    <h5>Detalle Retenciones</h5>
    <div class="col-md-12 text-center">
        <form [formGroup]="formulario">
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group has-float-label">
                        <label for="iMediosPagos" class="tamanio-label">Tipo de Retención *</label>
                        <mat-select id="idMediosPagos" class="form-control form-control-sm" [compareWith]="compareFn"
                            formControlName="tipoRetencion" (selectionChange)="cambioTipoRetencion()">
                            <mat-option *ngFor="let item of tiposRetencion" [value]="item">
                                {{item.nombre}}
                            </mat-option>
                        </mat-select>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group has-float-label">
                        <label for="idPuntoVenta" class="tamanio-label">Punto de Venta *</label>
                        <input id="idPuntoVenta" type="text" formControlName="puntoVenta"
                            class="form-control form-control-sm number-right" maxlength="5"
                            (blur)="establecerCerosIzq(formulario.get('puntoVenta'), '0000', -5)">
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group has-float-label ">
                        <label for="idLetra" class="tamanio-label">Letra *</label>
                        <input id="idLetra" type="text" formControlName="letra" class="form-control form-control-sm "
                            readonly>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group has-float-label ">
                        <label for="idNumero" class="tamanio-label">Número *</label>
                        <input id="idNumero" type="text" formControlName="numero"
                            class="form-control form-control-sm number-right"
                            (blur)="establecerCerosIzq(formulario.get('numero'), '0000000', -8)" maxlength="8">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-2">
                    <div class="form-group has-float-label">
                        <label for="iMediosPagos" class="tamanio-label">Año *</label>
                        <mat-select id="idMediosPagos" class="form-control form-control-sm" [compareWith]="compareFn"
                            formControlName="anio">
                            <mat-option *ngFor="let item of anios" [value]="item">
                                {{item}}
                            </mat-option>
                        </mat-select>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group has-float-label">
                        <label for="iMediosPagos" class="tamanio-label">Mes *</label>
                        <mat-select id="idMediosPagos" class="form-control form-control-sm" [compareWith]="compareFn"
                            formControlName="mes">
                            <mat-option *ngFor="let item of meses" [value]="item">
                                {{item.nombre}}
                            </mat-option>
                        </mat-select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group has-float-label">
                        <label for="iMediosPagos" class="tamanio-label">Provincia *</label>
                        <mat-select id="idMediosPagos" class="form-control form-control-sm" [compareWith]="compareFn"
                            formControlName="provincia">
                            <mat-option *ngFor="let item of provincias" [value]="item">
                                {{item.nombre}}
                            </mat-option>
                        </mat-select>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group has-float-label">
                        <label for="idImporte" class="tamanio-label">Importe *</label>
                        <input id="idImporte" type="text" formControlName="importe" [textMask]="mascararImporte(8, 2)"
                            (blur)="setDecimales(formulario.get('importe'), 2)" class="form-control form-control-sm number-right"
                            required>
                    </div>
                </div>
                <div class="col-md-1">
                    <button id="idBotonAgregar" mat-raised-button color="primary" (click)="agregarDetalleRetencion()"
                        [disabled]="!formulario.valid">Agregar</button>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-12">
                    <div class="tabla">
                        <table mat-table [dataSource]="listaCompleta" matSort class="mat-elevation-z1">
                            <ng-container matColumnDef="TIPO_RETENCION">
                                <th mat-header-cell *matHeaderCellDef></th>
                                <td mat-cell *matCellDef="let elemento">{{elemento.tipoRetencion.nombre}}</td>
                            </ng-container>
                            <ng-container matColumnDef="PUNTO_VENTA">
                                <th mat-header-cell *matHeaderCellDef>P. Venta</th>
                                <td mat-cell *matCellDef="let elemento" class="number-right">
                                    {{completarCeros(elemento.puntoVenta,'0000',-5)}}
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="NUMERO">
                                <th mat-header-cell *matHeaderCellDef clas>Tipo</th>
                                <td mat-cell *matCellDef="let elemento" class="number-right">{{elemento.numero}}
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="ANIO">
                                <th mat-header-cell *matHeaderCellDef>Año</th>
                                <td class="number-right" mat-cell *matCellDef="let elemento">
                                    {{elemento.anio}}</td>
                            </ng-container>
                            <ng-container matColumnDef="MES">
                                <th mat-header-cell *matHeaderCellDef>Mes</th>
                                <td mat-cell *matCellDef="let elemento">{{elemento.mes.nombre}}</td>
                            </ng-container>
                            <ng-container matColumnDef="PROVINCIA">
                                <th mat-header-cell *matHeaderCellDef>Provincia</th>
                                <td class="number-right" mat-cell *matCellDef="let elemento">
                                    {{elemento.provincia? elemento.provincia.nombre : ''}}</td>
                            </ng-container>
                            <ng-container matColumnDef="IMPORTE">
                                <th mat-header-cell *matHeaderCellDef>Importe </th>
                                <td class="number-right" mat-cell *matCellDef="let elemento">
                                    ${{elemento.importe ? (elemento.importe | number: '1.2-2') : '0.00'}}
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="ELIMINAR">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
                                <td mat-cell *matCellDef="let elemento; let i=index">
                                    <span class="cursor-color-rojo" (click)="eliminarDetalleRetencion(i)">
                                        X
                                    </span>
                                </td>
                            </ng-container>
                            <tr mat-header-row *matHeaderRowDef="columnas"></tr>
                            <tr mat-row *matRowDef="let row; columns: columnas;"></tr>
                        </table>
                    </div>
                </div>
            </div>
            <br>
            <div class="row justify-content-end">
                <div class="col-md-3">
                    <div class="form-group has-float-label">
                        <label for="idImporteTotal" class="tamanio-label">Total</label>
                        <input id="idImporteTotal" type="text" [formControl]="importeTotal"
                            [textMask]="mascararImporte(8, 2)" (blur)="setDecimales(formulario.get('importe'), 2)"
                            class="form-control form-control-sm number-right" required>
                    </div>
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-md-1">
                    <button id="idBotonConfirmar" mat-raised-button color="primary"
                        [mat-dialog-close]="listaCompleta.data" [disabled]="listaCompleta.data.length == 0">Confirmar</button>
                </div>
                <div class="col-md-1">
                    <button id="idBotonCerrar" mat-raised-button color="secondary"
                        [mat-dialog-close]="[]">Cerrar</button>
                </div>
            </div>
        </form>
    </div>
</div>